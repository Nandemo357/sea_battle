<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—Ä—Å—å–∫–∏–π –±—ñ–π</title>
    <style>
		body {
			background-image: url('seas2.gif');
            background-size:cover;
			color: white;
        }
        table {
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        table,
        th,
        td {
            border: 1px solid black;
            display: inline-block;
			left:50%;
        }

        th,
        td {
            width: 30px;
            height: 30px;
            text-align: center;
        }

        th {
            background-color: #ccc;
        }

        td {
            cursor: pointer;
        }

        .board-container {
            display: flex;
            flex-direction: row;
        }
		#computerBoard{
			left:50%;
		}
		.user{
			position:relative;
			margin-left:5%;
			margin-top:5%;
			background-color:#DCDCDC;
			visibility:50;
			color: black;
			text-align:center;
		}
		.bot{
			position:relative;
			margin-left:55%;
			margin-top:5%;
			background-color:#DCDCDC;
			visibility:50;
			color: black;
			text-align:center;
		}
		.score{
			position:relative;
			margin-left:40%;
			margin-top:-15%;
			background-color:#DCDCDC;
			visibility:50;
			color: black;
			text-align:center;
			width:20%;
			padding:5px;
		}
		.arsenal{
			position:relative;
			margin-left:40%;
			margin-top:10%;
			background-color:#DCDCDC;
			visibility:50;
			color: black;
			text-align:center;
			width:20%;
			padding:5px;
		}
		.restart{
			position:relative;
			margin-left:45%;
			margin-top:1%;
			background-color:#DCDCDC;
			visibility:50;
			color: black;
			text-align:center;
			font-size:25px;
			width:10%;
			padding:5px;
		}
    </style>
</head>

<body>

    <div class="board-container">
        <div class="user">
            <h2>–í–∞—à–µ –ø–æ–ª–µ</h2>
            <table id="userBoard" class="userBoard"></table>
        </div>
	
        <div class="bot">
            <h2>–ü–æ–ª–µ –∫–æ–º–ø'—é—Ç–µ—Ä–∞</h2>
            <table id="computerBoard" class="computerBoard"></table>
        </div>
    </div>
	
	<div class="score">
	<h1>–†–∞—Ö—É–Ω–æ–∫:</h1>
	<h2>–í–∏ <input class="text" id='you' value='0'> 
		<br>–ö–æ–º–ø'—é—Ç–µ—Ä <input class="text" id='you2' value='0'></h2>
	</div>
	
	<div class="arsenal">
		<h1>–ê—Ä—Å–µ–Ω–∞–ª:</h1>
		<label for="bomb"><input type="checkbox" id="bomb" onclick="bomb()">–ë–æ–º–±–æ—á–∫–∞ üí£</label><br>
		<label for="torpedo"><input type="checkbox" id="torpedo" onclick="torpedo()">–¢–æ—Ä–ø–µ–¥–∞ ‚úè</label><br>
	</div>
	
	<button id="restart" onclick="restart()" class='restart'>Restart game</button>

    <script>
        // –†–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –ø–æ–ª—è
        const boardSize = 10;

        // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø—É—Å—Ç–æ–≥–æ –ø–æ–ª—è
        function generateEmptyBoard() {
            const board = [];
            for (let i = 0; i < boardSize; i++) {
                board.push(new Array(boardSize).fill(0));
            }
            return board;
        }

        // –í–∏–≤—ñ–¥ –ø–æ–ª—è –Ω–∞ –µ–∫—Ä–∞–Ω
        function renderBoard(board, elementId, clickHandler) {
            const table = document.getElementById(elementId);
            table.innerHTML = '';

            for (let i = 0; i < board.length; i++) {
                const row = table.insertRow(0);
                for (let j = 0; j < board[i].length; j++) {
                    const cell = row.insertCell(j);
                    cell.addEventListener('click', () => clickHandler(i, j));
                    if (board[i][j] === 1) {
                        cell.style.backgroundColor = 'blue';} // –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∫–æ—Ä–∞–±–ª—ñ–≤
					else if (board[i][j] === 2) {
                        cell.style.backgroundColor = 'black';}
					else if (board[i][j] === 'hit') {
                        cell.style.backgroundColor = 'red';
						} 										// –ß–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –ø–æ–ø–∞–¥–∞–Ω—å
                    else if (board[i][j] === 'miss') {
                        cell.style.backgroundColor = 'gray';} // –ñ–æ–≤—Ç–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –ø—Ä–æ–º–∞—Ö—ñ–≤
                    else if (board[i][j] === 'playerMove') {
                        cell.style.backgroundColor = 'gray';} // –ß–µ—Ä–≤–æ–Ω–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –≤—ñ–¥–º—ñ—á–µ–Ω–Ω—è —Ö–æ–¥—É –≥—Ä–∞–≤—Ü—è –Ω–∞ –ø–æ–ª—ñ –∫–æ–º–ø'—é—Ç–µ—Ä–∞
                    else if (board[i][j] === 'computerMove') {
                        cell.style.backgroundColor = 'gray';}
					else if (board[i][j] === 'paintteritory') {
                        cell.style.backgroundColor = 'yellow';// –°—ñ—Ä–∏–π –∫–æ–ª—ñ—Ä –¥–ª—è –≤—ñ–¥–º—ñ—á–µ–Ω–Ω—è —Ö–æ–¥—É –∫–æ–º–ø'—é—Ç–µ—Ä–∞ –Ω–∞ –ø–æ–ª—ñ –≥—Ä–∞–≤—Ü—è
                    }
                }
            }
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ—Ä–∞–±–ª—ñ–≤ –Ω–∞ –ø–æ–ª—ñ
		function placeShips(board) {
			for (let i = 0; i < 5; i++) {
				let shipCol, shipRow;

				do {
					shipCol = Math.floor(Math.random() * boardSize);
					shipRow = Math.floor(Math.random() * boardSize);
				} while (!isShipPlacementValid(board, shipRow, shipCol));

				board[shipRow][shipCol] = 1;
			}
		}

		function isShipPlacementValid(board, row, col) {
			for (let i = row - 1; i <= row + 1; i++) {
				for (let j = col - 1; j <= col + 1; j++) {
					if (i >= 0 && i < boardSize && j >= 0 && j < boardSize) {
						if (board[i][j] === 1) {
							return false;
						}
					}
				}
			}
			return true;
		}

		let userScore = 0;
		let computerScore = 0;
        // –ì—Ä–∞–≤–µ—Ü—å —Å—Ç—Ä—ñ–ª—è—î
		function userShoot(row, col) {
			if (computerBoard[row][col] === 1) {
				alert('–í–∏ –ø–æ–ø–∞–ª–∏!');
				computerBoard[row][col] = 'hit';
				userScore++;
				document.getElementById('you').value = userScore;

				if (userScore === 5) {
					alert('–í–∏ –ø–µ—Ä–µ–º–æ–≥–ª–∏!');
					resetGame();
				}
			}
			else if (computerBoard[row][col] === 2) {
				alert('–í–∏ –ø–æ–ø–∞–ª–∏ –Ω–∞ –±–æ–º–±—É!');
				userBoard[row][col] = 'hit';
				computerBoard[row][col] = 'hit';
			}
			else {
				alert('–í–∏ –ø—Ä–æ–º–∞–∑–∞–ª–∏!');
				computerBoard[row][col] = 'miss'; // –ü–æ–∑–Ω–∞—á–∞—î–º–æ –ø—Ä–æ–º–∞—Ö –Ω–∞ –ø–æ–ª—ñ –∫–æ–º–ø'—é—Ç–µ—Ä–∞
			}

    // Remove the following line, as it overrides the hit status with 'miss'
    // computerBoard[row][col] = 'playerMove';

		renderBoard(computerBoard, 'computerBoard', userShoot); // –û–Ω–æ–≤–ª—é—î–º–æ –ø–æ–ª–µ –∫–æ–º–ø'—é—Ç–µ—Ä–∞
		if (userScore < 5) {
			computerShoot();
    }
}

	
		
        // –ö–æ–º–ø'—é—Ç–µ—Ä —Å—Ç—Ä—ñ–ª—è—î
        function computerShoot() {
            let row, col;
            do {
                row = Math.floor(Math.random() * boardSize);
                col = Math.floor(Math.random() * boardSize);
            } while (userBoard[row][col] === 'computerMove' || userBoard[row][col] === 'hit' || userBoard[row][col] === 'miss');

            if (userBoard[row][col] === 1) {
                alert('–ö–æ–º–ø\'—é—Ç–µ—Ä –ø–æ–ø–∞–≤!');
                userBoard[row][col] = 'hit'; // –ü–æ–∑–Ω–∞—á–∞—î–º–æ –ø–æ–ø–∞–¥–∞–Ω–Ω—è –Ω–∞ –ø–æ–ª—ñ –≥—Ä–∞–≤—Ü—è
				computerScore++;
				document.getElementById('you2').value = computerScore;

				if (computerScore === 5) {
					alert('–ö–æ–º–ø\'—é—Ç–µ—Ä –ø–µ—Ä–µ–º—ñ–≥!');
					resetGame();
				}
            } else {
                alert('–ö–æ–º–ø\'—é—Ç–µ—Ä –ø—Ä–æ–º–∞–∑–∞–≤!');
                userBoard[row][col] = 'miss'; // –ü–æ–∑–Ω–∞—á–∞—î–º–æ –ø—Ä–æ–º–∞—Ö –Ω–∞ –ø–æ–ª—ñ –≥—Ä–∞–≤—Ü—è
            }

            renderBoard(userBoard, 'userBoard', userShoot); // –û–Ω–æ–≤–ª—é—î–º–æ –ø–æ–ª–µ –≥—Ä–∞–≤—Ü—è
        }

        const userBoard = generateEmptyBoard();
        const computerBoard = generateEmptyBoard();

        placeShips(userBoard);
        placeShips(computerBoard);

        renderBoard(userBoard, 'userBoard', userShoot);
        renderBoard(computerBoard, 'computerBoard', userShoot);
		
		
		function placeBombs(board) {
			for (let i = 0; i < 5; i++) {
				let bombCol, bombRow;

				do {
					bombCol = Math.floor(Math.random() * boardSize);
					bombRow = Math.floor(Math.random() * boardSize);
				} while (!isBombPlacementValid(board, bombRow, bombCol));

				board[bombRow][bombCol] = 2;
			}
		}

		function isBombPlacementValid(board, row, col) {
			for (let i = row - 1; i <= row + 1; i++) {
				for (let j = col - 1; j <= col + 1; j++) {
					if (i >= 0 && i < boardSize && j >= 0 && j < boardSize) {
						if (board[i][j] === 1) {
							return false;
						}
					}
				}
			}
			return true;
		}
		
		
		function handleBomb(row, col, userBoard, computerBoard) {
			if (computerBoard[row][col] === 2) {
				alert('–í–∏ –ø–æ–ø–∞–ª–∏ –Ω–∞ –±–æ–º–±—É!');
				if (userBoard[row][col] === 1) {
					userBoard[row][col] = 'hit';
					computerBoard[row][col] = 'miss';
				} else {
					userBoard[row][col] = 'miss';
					computerBoard[row][col] = 'miss';
				}
			}

			renderBoard(userBoard, 'userBoard', userShoot);
			renderBoard(computerBoard, 'computerBoard', userShoot);

			computerShoot();
		}


		
		function handleComputerBomb(row, col, userBoard, computerBoard) {
			if (userBoard[row][col] === 2) {
				alert('–ö–æ–º–ø\'—é—Ç–µ—Ä –ø–æ–ø–∞–≤ –Ω–∞ –≤–∞—à –∫–æ—Ä–∞–±–µ–ª—å!');
				computerBoard[row][col] = 'hit';
				userBoard[row][col] = 'hit'; 
			} else {
				alert('–ö–æ–º–ø\'—é—Ç–µ—Ä –ø—Ä–æ–º–∞–∑–∞–≤ –Ω–∞ –≤–∞—à –∫–æ—Ä–∞–±–µ–ª—å!');
				computerBoard[row][col] = 'miss';
				userBoard[row][col] = 'miss';
			}

			renderBoard(userBoard, 'userBoard', userShoot);
			renderBoard(computerBoard, 'computerBoard', userShoot);

		}
		
		function bomb() {
			const bombCheckbox = document.getElementById('bomb');

			if (bombCheckbox.checked) {
				placeBombs(userBoard, computerBoard);
				placeBombs(computerBoard, userBoard);
				renderBoard(userBoard, 'userBoard', userShoot);
				renderBoard(computerBoard, 'computerBoard', userShoot);

		
			}
		}
		
		function torpedo() {
			const torpedoCheckbox = document.getElementById('torpedo');

			if (torpedoCheckbox.checked) {
				let rowt = prompt('Which row do you want to send a torpedo to (starting from the end)?')-1;
				

				for (let i = 0; i < boardSize; i++) {
					if (computerBoard[rowt][i] === 1) {
						alert(`–ö–æ—Ä–∞–±–µ–ª—å –≤ ${rowt+1} —Ä—è–¥—É —Ç–∞ ${i+1} –∫–æ–ª–æ–Ω—Ü—ñ!`);
						computerBoard[rowt][i] = 'hit';
					} else if (computerBoard[rowt][i] === 2) {
						alert(`–ë–æ–º–±–∞ –≤ ${rowt+1} —Ä—è–¥—É —Ç–∞ ${i+1} –∫–æ–ª–æ–Ω—Ü—ñ!`);
						computerBoard[rowt][i] = 'hit';
					} else {
						computerBoard[rowt][i] = 'miss';
					}
				}

				renderBoard(userBoard, 'userBoard', userShoot);
				renderBoard(computerBoard, 'computerBoard', userShoot, true);

				if (userScore < 5) {
					computerShoot();
				}
			}
		}
		
		function restart() {
			userScore = 0;
			computerScore = 0;
			document.getElementById('you').value = 0;
			document.getElementById('you2').value = 0;

			document.getElementById('bomb').checked = false;
			document.getElementById('torpedo').checked = false;

			const userBoard = generateEmptyBoard();
			const computerBoard = generateEmptyBoard();

			placeShips(userBoard);
			placeShips(computerBoard);
			
			renderBoard(userBoard, 'userBoard', userShoot);
			renderBoard(computerBoard, 'computerBoard', userShoot);
		}


		
    </script>

</body>

</html>